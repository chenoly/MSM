<div align="center">
<h1>Mixed-bit Sampling Watermark: Generating Texture Patterns for Document Authentication</h1>

Jiale Chen, Li Dong, Rangding Wang, Diqun Yan, and Wei Wang

Department of Computer Science, Ningbo University & Beijing Institute of Technology
</div>

# Introduction
1. This is the official implementation of the paper titled *"Mixed-bit Sampling Watermark: Generating Texture Patterns for Document Authentication."*
2. The work is based on our preliminary research, and more details can be found at [GitHub Repository](https://github.com/chenoly/MSG).
3. The dataset used in this work is publicly available at [Kaggle](https://www.kaggle.com/datasets/chenoly/msw-dataset).

## Overview
Counterfeiting poses severe risks to consumers and businesses alike. Recently, Printable Graphic Codes (PGCs) have gained traction due to their cost-effectiveness and high authentication performance. Among these, Copy Detection Patterns (CDPs) and Two-Level QR Codes (2LQR) are two prominent solutions. CDPs are noise images generated using a secret key mechanism, but they don't embed any additional information. In contrast, 2LQR codes replace the standard black modules of QR codes with specially designed texture patterns. However, due to the limited variety of these patterns, 2LQR codes face significant security vulnerabilities.

To address these challenges, this work treats CDPs as random noise images composed of multiple texture patterns, similar to the texture patterns found in 2LQR codes. Each texture pattern represents one bit. By designing how these texture patterns are generated, we can unify both CDP and 2LQR codes under a single framework.

We propose a constrained optimization framework, termed Mixed-bit Sampling Watermark (MSW), to generate these texture patterns. The objective function balances the white pixel ratio and spatial randomness of the patterns, while the constraints are defined by a flexible watermark embedding function (e.g., DCT-based watermarking or Pearson similarity). We introduce a two-step sampling algorithm to solve this optimization problem.

This paper presents two concrete examples of the MSW framework and compares them with CDPs and 2LQR codes. Experimental results demonstrate that the texture patterns generated by MSW effectively address the limitations present in both CDP and 2LQR systems.

## Supplementary experimental results

![](all_result_1.png)
![](all_result_2.png)

## Requirements
- Python
- bchlib==0.14.0
- opencv-python==3.4.2.16
- numpy
- scikit-image
- scipy
- hashlib
- pytorch
